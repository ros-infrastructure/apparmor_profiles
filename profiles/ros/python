# ------------------------------------------------------------------
#
#    Copyright (C) 2019 Open Source Robotics Foundation
#
#    This program is free software; you can redistribute it and/or
#    modify it under the terms of version 2 of the GNU General Public
#    License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

# Include python abstractions and excutables needed for ros with python
#include <abstractions/python>

# CHECKME: Which are general for other languages?
/bin/dash mrix,
/bin/uname mrix,

# CHECKME: Is this already in abstractions somewhere?
owner @{PROC}/@{pid}/cgroup r,
owner @{PROC}/@{pid}/cmdline r,
owner @{PROC}/@{pid}/fd/ r,

/usr/bin/python3.[0-9]* ix,
/usr/local/lib/python3.[0-9]*/dist-packages/{,**} mr,

@{ROS_INSTALL_PYTHON}/site-packages/{,**} mr,
deny @{ROS_INSTALL_PYTHON}/site-packages/**/__pycache__ w,
owner @{HOME}/.local/lib/python3.[0-9]*/site-packages/{,**} mr,
deny owner @{HOME}/.local/lib/python3.[0-9]*/site-packages/**/__pycache__ w,

# CHECKME: why are each of these needed?
/etc/apt/apt.conf.d/{,**} r,
/etc/default/apport r,
/usr/share/dpkg/cputable r,
/usr/share/dpkg/tupletable r,

# CHECKME: Why are nodes trying to read OpenSSL Configuration File
#/etc/ssl/openssl.cnf r,
